#include <stdio.h>
#include <stdlib.h>
struct Node{
    int data;
    struct Node* next;
};
void push(struct Node** head_ref, int new_data){
    struct Node*new_node=(struct Node*)malloc(sizeof(struct Node));
    new_node->data=new_data;
    new_node->next=(*head_ref);
    (*head_ref)=new_node;
}
void ins_at_pos_n(struct Node**head,int data, int position){
    struct Node*ptr=(struct Node*)malloc(sizeof(struct Node));
    ptr->data=data;
    int i;
    struct Node* temp=*head;
    if (position==1){
        ptr->next=temp;
        *head=ptr;
        return;
    }
    for(i=1;i<position-1;i++){
        temp=temp->next;
    }
    ptr->next=temp->next;
    temp->next=ptr;
}
void append(struct Node**head_ref,int new_data){
    struct Node*new_node=(struct Node*)malloc(sizeof(struct Node));
    struct Node*last=*head_ref;
    new_node->data=new_data;
    new_node->next=NULL;
    if(*head_ref==NULL){
        *head_ref=new_node;
        return;
    }
    while(last->next!=NULL)
        last=last->next;
    last->next=new_node;
    return;
}

void del_front(struct Node**head){
    if(*head==NULL)
        return;
    struct Node*temp=*head;
    *head=(*head)->next;
    free(temp);
}
void del_end(struct Node**head){
    if(*head==NULL)
        return;
    struct Node*temp=*head;
    if(temp->next==NULL){
        free(temp);
        *head=NULL;
        return;
    }
    while(temp->next->next!=NULL)
        temp=temp->next;
    free(temp->next);
    temp->next=NULL;
}
void del_at_pos(struct Node**head,int position){
    if(*head==NULL)
        return;
    struct Node*temp=*head;
    if(position==1){
        *head=temp->next;
        free(temp);
        return;
    }
    int i;
    for(i=1;i<position-1;i++){
        if(temp==NULL || temp->next==NULL)
            return;
        temp=temp->next;
    }
    struct Node*del=temp->next;
    if(del==NULL)
        return;
    temp->next=del->next;
    free(del);
}
void printList(struct Node*node){
    while(node!=NULL){
        printf("%d ",node->data);
        node=node->next;
    }
    printf("\n");
}
int main(){
    struct Node*head=NULL;
    int ele,pos;
    int choice;
    printf("The available options are:\n1)Insert at front\n2)Insert at position\n3)Insert at end\n4)Display list\n5)Delete from front\n6)Delete from end\n7)Delete at position\nAny other key to exit\n");
    while(1){
        printf("Enter your choice ");
        scanf("%d",&choice);
        switch(choice){
        case 1:
            printf("Enter element to push: ");
            scanf("%d",&ele);
            push(&head,ele);
            break;
        case 2:
            printf("Enter position to insert in: ");
            scanf("%d",&pos);
            printf("Enter element to insert: ");
            scanf("%d",&ele);
            ins_at_pos_n(&head,ele,pos);
            break;
        case 3:
            printf("Enter element to append: ");
            scanf("%d",&ele);
            append(&head,ele);
            break;
        case 4:
            printf("Displaying LINKED LIST\n");
            printList(head);
            break;
        case 5:
            del_front(&head);
            break;
        case 6:
            del_end(&head);
            break;
        case 7:
            printf("Enter position to delete: ");
            scanf("%d",&pos);
            del_at_pos(&head,pos);
            break;
        default:
            exit(0);
        }
    }
    return 0;
}
